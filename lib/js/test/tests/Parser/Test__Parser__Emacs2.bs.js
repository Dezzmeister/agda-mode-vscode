// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("rescript/lib/js/curry.js");
var Assert = require("assert");
var Js_dict = require("rescript/lib/js/js_dict.js");
var Util$AgdaModeVscode = require("../../../src/Util/Util.bs.js");
var Emacs__Parser2$AgdaModeVscode = require("../../../src/View/Panel/Emacs/Emacs__Parser2.bs.js");

function tempNormalize(xs) {
  return Js_dict.map((function (value) {
                return value.map(function (x) {
                            return Util$AgdaModeVscode.$$String.unlines(Util$AgdaModeVscode.$$String.lines(x));
                          });
              }), xs);
}

describe("when running Emacs__Parser2.parseGoalType", (function () {
        it("should parse goal only", (function () {
                var actual = Emacs__Parser2$AgdaModeVscode.parseGoalType("Goal: ℕ\r\n————————————————————————————————————————————————————————————");
                var expected = Object.fromEntries([[
                        "goal",
                        ["Goal: ℕ"]
                      ]]);
                Curry._3(Assert.deepEqual, actual, expected, undefined);
              }));
        it("should parse goal + have", (function () {
                var actual = Emacs__Parser2$AgdaModeVscode.parseGoalType("Goal: ℕ\r\nHave: ℕ\r\n————————————————————————————————————————————————————————————");
                var expected = Object.fromEntries([
                      [
                        "goal",
                        ["Goal: ℕ"]
                      ],
                      [
                        "have",
                        ["Have: ℕ"]
                      ]
                    ]);
                Curry._3(Assert.deepEqual, actual, expected, undefined);
              }));
        it("should parse goal + have + context", (function () {
                var actual = Emacs__Parser2$AgdaModeVscode.parseGoalType("Goal: ℕ\r\nHave: ℕ\r\n————————————————————————————————————————————————————————————\r\ny : ℕ\r\nx : ℕ");
                var expected = Object.fromEntries([
                      [
                        "goal",
                        ["Goal: ℕ"]
                      ],
                      [
                        "have",
                        ["Have: ℕ"]
                      ],
                      [
                        "interactionMetas",
                        [
                          "y : ℕ",
                          "x : ℕ"
                        ]
                      ]
                    ]);
                Curry._3(Assert.deepEqual, actual, expected, undefined);
              }));
      }));

describe("when running Emacs__Parser2.parseAllGoalsWarnings", (function () {
        it("should parse goals only", (function () {
                var actual = Emacs__Parser2$AgdaModeVscode.parseAllGoalsWarnings("*All Goals*", "\r\n?0 : ℕ\r\n?1 : ℕ\r\nSort _0  [ at /Users/banacorn/agda/examples/A.agda:11,5-20 ]\r\n");
                var expected = Object.fromEntries([
                      [
                        "interactionMetas",
                        [
                          "?0 : ℕ",
                          "?1 : ℕ"
                        ]
                      ],
                      [
                        "hiddenMetas",
                        ["Sort _0  [ at /Users/banacorn/agda/examples/A.agda:11,5-20 ]"]
                      ]
                    ]);
                Curry._3(Assert.deepEqual, actual, expected, undefined);
              }));
        it("should parse goals + errors", (function () {
                var actual = Emacs__Parser2$AgdaModeVscode.parseAllGoalsWarnings("*All Goals, Errors*", "?0 : _2\r\n\r\n———— Errors ————————————————————————————————————————————————\r\nUnsolved constraints");
                var expected = Object.fromEntries([
                      [
                        "interactionMetas",
                        ["?0 : _2"]
                      ],
                      [
                        "errors",
                        ["Unsolved constraints"]
                      ]
                    ]);
                Curry._3(Assert.deepEqual, actual, expected, undefined);
              }));
        it("should parse goals that span multiple lines", (function () {
                var actual = Emacs__Parser2$AgdaModeVscode.parseAllGoalsWarnings("*All Goals, Errors*", "?0\r\n  : BoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBool");
                var expected = tempNormalize(Object.fromEntries([[
                            "interactionMetas",
                            ["?0\r\n  : BoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBoolBool"]
                          ]]));
                Curry._3(Assert.deepEqual, actual, expected, undefined);
              }));
      }));

describe("when running Emacs__Parser2.parseError", (function () {
        it("should parse an error only", (function () {
                var actual = Emacs__Parser2$AgdaModeVscode.parseError("/Users/banacorn/agda/examples/A.agda:15,1-2\r\nThe right-hand side can only be omitted if there is an absurd\r\npattern, () or {}, in the left-hand side.\r\nwhen checking that the clause a has type _8");
                var expected = tempNormalize(Object.fromEntries([[
                            "errors",
                            ["/Users/banacorn/agda/examples/A.agda:15,1-2\r\nThe right-hand side can only be omitted if there is an absurd\r\npattern, () or {}, in the left-hand side.\r\nwhen checking that the clause a has type _8"]
                          ]]));
                Curry._3(Assert.deepEqual, actual, expected, undefined);
              }));
        it("should parse an error + warnings", (function () {
                var actual = Emacs__Parser2$AgdaModeVscode.parseError("———— Error —————————————————————————————————————————————————\r\n/Users/banacorn/agda/examples/A.agda:15,1-2\r\nThe right-hand side can only be omitted if there is an absurd\r\npattern, () or {}, in the left-hand side.\r\nwhen checking that the clause a has type _8\r\n\r\n———— Warning(s) ————————————————————————————————————————————\r\n/Users/banacorn/agda/examples/A.agda:17,1-8\r\nThe following names are declared but not accompanied by a\r\ndefinition: boo\r\n/Users/banacorn/agda/examples/A.agda:9,1-10\r\nUnreachable clause\r\nwhen checking the definition of _+_");
                var expected = tempNormalize(Object.fromEntries([
                          [
                            "errors",
                            ["/Users/banacorn/agda/examples/A.agda:15,1-2\r\nThe right-hand side can only be omitted if there is an absurd\r\npattern, () or {}, in the left-hand side.\r\nwhen checking that the clause a has type _8"]
                          ],
                          [
                            "warnings",
                            [
                              "/Users/banacorn/agda/examples/A.agda:9,1-10\r\nUnreachable clause\r\nwhen checking the definition of _+_",
                              "/Users/banacorn/agda/examples/A.agda:17,1-8\r\nThe following names are declared but not accompanied by a\r\ndefinition: boo"
                            ]
                          ]
                        ]));
                Curry._3(Assert.deepEqual, actual, expected, undefined);
              }));
      }));

exports.tempNormalize = tempNormalize;
/*  Not a pure module */
